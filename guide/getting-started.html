<!DOCTYPE html>
<html lang="Englih">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting Started | vuci</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/vuci/assets/css/0.styles.e1ba4a03.css" as="style"><link rel="preload" href="/vuci/assets/js/app.80f1f43f.js" as="script"><link rel="preload" href="/vuci/assets/js/2.87865a9c.js" as="script"><link rel="preload" href="/vuci/assets/js/3.c5fed848.js" as="script"><link rel="prefetch" href="/vuci/assets/js/10.15532a41.js"><link rel="prefetch" href="/vuci/assets/js/11.7fb148c6.js"><link rel="prefetch" href="/vuci/assets/js/12.09bb99d9.js"><link rel="prefetch" href="/vuci/assets/js/13.cd9febda.js"><link rel="prefetch" href="/vuci/assets/js/14.df9d5003.js"><link rel="prefetch" href="/vuci/assets/js/15.9df0a31f.js"><link rel="prefetch" href="/vuci/assets/js/16.35699745.js"><link rel="prefetch" href="/vuci/assets/js/17.824011ed.js"><link rel="prefetch" href="/vuci/assets/js/18.41184049.js"><link rel="prefetch" href="/vuci/assets/js/4.05893b4a.js"><link rel="prefetch" href="/vuci/assets/js/5.d430a1f0.js"><link rel="prefetch" href="/vuci/assets/js/6.e5754fe4.js"><link rel="prefetch" href="/vuci/assets/js/7.474c027a.js"><link rel="prefetch" href="/vuci/assets/js/8.f61319cb.js"><link rel="prefetch" href="/vuci/assets/js/9.75677024.js">
    <link rel="stylesheet" href="/vuci/assets/css/0.styles.e1ba4a03.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuci/" class="home-link router-link-active"><!----> <span class="site-name">vuci</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuci/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/vuci/uci/" class="nav-link">
  uci
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuci/guide/getting-started.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Englih
</a></li><li class="dropdown-item"><!----> <a href="/vuci/zh/guide/getting-started.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/zhaojh329/vuci" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuci/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/vuci/uci/" class="nav-link">
  uci
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuci/guide/getting-started.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Englih
</a></li><li class="dropdown-item"><!----> <a href="/vuci/zh/guide/getting-started.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/zhaojh329/vuci" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/vuci/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/vuci/guide/compile.html" class="sidebar-link">Compile</a></li><li><a href="/vuci/guide/getting-started.html" aria-current="page" class="active sidebar-link">Getting Started</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#debugging-front-end-code" class="sidebar-link">Debugging front-end code</a></li><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#web-console-debugging" class="sidebar-link">Web Console Debugging</a></li><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#uci" class="sidebar-link">$uci</a></li><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#ubus" class="sidebar-link">$ubus</a></li><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#string-format" class="sidebar-link">String.format</a></li><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#how-to-add-a-page" class="sidebar-link">How to add a page</a></li><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#how-to-register-ubus-service" class="sidebar-link">How to register UBUS service</a></li><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#access-data" class="sidebar-link">Access Data</a></li><li class="sidebar-sub-header"><a href="/vuci/guide/getting-started.html#multilingual-support" class="sidebar-link">Multilingual support</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting Started</h1> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>To read this tutorial, developers need to have knowledge of <a href="https://cn.vuejs.org/" target="_blank" rel="noopener noreferrer">vue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://element.eleme.io" target="_blank" rel="noopener noreferrer">element-ui<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h2 id="debugging-front-end-code"><a href="#debugging-front-end-code" class="header-anchor">#</a> Debugging front-end code</h2> <p>Debugging front-end code is unbearable if we compile it every time we modify it and upload it to the device.</p> <p>Webpack provides hot update technology. We can make every change displaied on our browser immediately.</p> <p>1.Install <a href="https://nodejs.org" target="_blank" rel="noopener noreferrer">nodejs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>(8.11.0+). You can manage multiple versions of Node on the same machine
with <a href="https://github.com/creationix/nvm" target="_blank" rel="noopener noreferrer">nvm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://github.com/coreybutler/nvm-windows" target="_blank" rel="noopener noreferrer">nvm-windows<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>2.Clone the vuci code to any location on your development host machine.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/zhaojh329/vuci.git
</code></pre></div><p>3.Enter：vuci/vuci-ui-core/src/</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> vuci/vuci-ui-core/src/
</code></pre></div><p>4.Modify the proxy configuration: replace <code>openwrt.lan</code> in <code>vue.config.js</code> with the IP address of your device.</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">indexPath</span><span class="token operator">:</span> <span class="token string">'vuci.html'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">productionSourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'/ubus'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'http://openwrt.lan'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string-property property">'/cgi-bin/'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'http://openwrt.lan'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>5.Install dependency packages</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span>
</code></pre></div><p>6.Start the Debugging Server</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run serve
</code></pre></div><p>7.According to the output prompt, access the debugging server in the browser. At this point, your code changes will be immediately updated to the browser.</p> <h2 id="web-console-debugging"><a href="#web-console-debugging" class="header-anchor">#</a> Web Console Debugging</h2> <p>Webpack builds Vue code in two versions, one for the development version(the debugging described in the previous section is the development version) and the other for the production version.
In the development version, vuci exported UCI and UBUS tools for debugging.</p> <p>Press the F12 shortcut to open the browser's console, where we can query the UCI configuration and call ubus.
<img src="/vuci/assets/img/web_con.e86e8e68.png" alt=""></p> <h2 id="uci"><a href="#uci" class="header-anchor">#</a> $uci</h2> <p>Vuci adds the attribute <code>$uci</code> to the Vue instance, which provides a series of methods for manipulating uci.</p> <p>Refer to the source code for specific usage：<code>vuci/vuci-ui-core/src/src/plugins/uci.js</code></p> <h2 id="ubus"><a href="#ubus" class="header-anchor">#</a> $ubus</h2> <p>Vuci adds the attribute <code>$ubus</code> to the Vue instance, which provides a series of methods for call ubus.</p> <p>Refer to the source code for specific usage：<code>vuci/vuci-ui-core/src/src/plugins/ubus.js</code></p> <h2 id="string-format"><a href="#string-format" class="header-anchor">#</a> String.format</h2> <p>%t</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'%t'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">13124</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'3h 38m 44s'</span>
</code></pre></div><p>%m</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'%m'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'1.00 K'</span>
<span class="token string">'%M'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'1.00 K'</span>
<span class="token string">'%.3m'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1100</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'1.100 K'</span>
<span class="token string">'%mB'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1100</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'1.10 KB'</span>
</code></pre></div><p>%d</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'%d'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'10'</span>
<span class="token string">'%d, %d'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'5, 10'</span>
<span class="token string">'%5d'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'  123'</span>
<span class="token string">'%-5d'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'123  '</span>
<span class="token string">'%05d'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'00123'</span>
</code></pre></div><p>%s</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'This is a %s'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'pen'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'This is a pen'</span>
<span class="token string">'This is %s %s'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'pen'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'This is a pen'</span>
<span class="token string">'%5s'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'  abc'</span>
<span class="token string">'%-5s'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'abc  '</span>
</code></pre></div><p>%o</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'123 =&gt; %o'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'123 =&gt; 173'</span>
<span class="token string">'0x7b =&gt; %o'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0x7b</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'0x7b =&gt; 173'</span>
</code></pre></div><p>%b</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'123 =&gt; %b'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'123 =&gt; 1111011'</span>
<span class="token string">'0x7b =&gt; %b'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0x7b</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'0x7b =&gt; 1111011'</span>
</code></pre></div><p>%x</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'123 =&gt; %x'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'123 =&gt; 7b'</span>
</code></pre></div><p>%X</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'123 =&gt; %X'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'123 =&gt; 7B'</span>
</code></pre></div><p>%c</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'%c'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'a'</span>
<span class="token string">'%c'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0x61</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'a'</span>
</code></pre></div><p>%f</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'%f'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1.12345</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'1.12345'</span>
<span class="token string">'%.2f'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1.12345</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'1.12'</span>
</code></pre></div><h2 id="how-to-add-a-page"><a href="#how-to-add-a-page" class="header-anchor">#</a> How to add a page</h2> <h3 id="first-add-the-navigation-menu"><a href="#first-add-the-navigation-menu" class="header-anchor">#</a> First add the navigation menu</h3> <p>The navigation menu configuration file storage path is：<code>vuci-ui-core/files/usr/share/vuci/menu.d</code></p> <p>You can add in an existing menu configuration or create a new file. Navigation menu
is divided into first-level navigation menu and second-level navigation menu.</p> <p>For example, create a new navigation menu configuration file：<code>vuci-ui-core/files/usr/share/vuci/menu.d/test.json</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Test&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token number">90</span><span class="token punctuation">,</span>
    <span class="token property">&quot;view&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>The first <code>test</code> here indicates that the navigation path of the menu is <code>test</code></li> <li><code>title</code>: Navigation menu title</li> <li><code>index</code>: Used for sorting navigation menus, smaller and closer to the front</li> <li><code>view</code>: Vue component path corresponding to navigation menu</li></ul> <h3 id="add-pages-for-the-navigation-menu-just-added"><a href="#add-pages-for-the-navigation-menu-just-added" class="header-anchor">#</a> Add pages for the navigation menu just added</h3> <p>Create a very simple Vue component: <code>vuci/vuci-ui-core/src/src/views/test.vue</code></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Hello，Vuci<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Recompile vuci and update it to the device. The results are as follows:
<img src="/vuci/assets/img/example_nav.f69529a6.png" alt=""></p> <h3 id="secondary-navigation-menu"><a href="#secondary-navigation-menu" class="header-anchor">#</a> Secondary navigation menu</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Test&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token number">90</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;test/sub&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Sub test&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;view&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test/sub&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Delete the previously added <code>test.Vue</code> and add a new Vue component：<code>vuci/vuci-ui-core/src/src/views/test/sub.vue</code></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;template&gt;
  &lt;el-button type=&quot;primary&quot;&gt;Secondary navigation menu&lt;/el-button&gt;
&lt;/template&gt;
</code></pre></div><p>Recompile vuci and update it to the device. The results are as follows:
<img src="/vuci/assets/img/example_nav2.5a220d94.png" alt=""></p> <h2 id="how-to-register-ubus-service"><a href="#how-to-register-ubus-service" class="header-anchor">#</a> How to register UBUS service</h2> <p>All data accessed by vuci comes from the <code>ubus</code> service provided by the back end. So you have to register <code>ubus</code> for your data.</p> <p>For most of the data, OpenWrt has registered UBUS services for us. If not, we need to register ourselves.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>For UCI configuration files, OpenWrt's own software package <a href="https://openwrt.org/start?id=docs/techref/rpcd" target="_blank" rel="noopener noreferrer">rpcd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> has provided
us with UBUS services to manipulate UCI configuration files.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>root@OpenWrt:~<span class="token comment"># ubus -v list uci</span>
<span class="token string">'uci'</span> @301dba5a
        <span class="token string">&quot;configs&quot;</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token string">&quot;get&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;section&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;option&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;match&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Table&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;state&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;section&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;option&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;match&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Table&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;add&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;values&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Table&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;set&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;section&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;match&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Table&quot;</span>,<span class="token string">&quot;values&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Table&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;delete&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;section&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;match&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Table&quot;</span>,<span class="token string">&quot;option&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;options&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Array&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;rename&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;section&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;option&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;order&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;sections&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Array&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;changes&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;revert&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;commit&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;config&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;apply&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;rollback&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Boolean&quot;</span>,<span class="token string">&quot;timeout&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Integer&quot;</span>,<span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;confirm&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;rollback&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;ubus_rpc_session&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">}</span>
        <span class="token string">&quot;reload_config&quot;</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div></div> <p>OpenWrt provides a variety of ways to register UBUS services. An example of a counter is given here. The effect is as follows:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>root@OpenWrt:~<span class="token comment"># ubus -v list counter</span>
<span class="token string">'counter'</span> @18abaa64
        <span class="token string">&quot;get&quot;</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token string">&quot;add&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;value&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Integer&quot;</span><span class="token punctuation">}</span>
root@OpenWrt:~<span class="token comment"># ubus call counter get</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
root@OpenWrt:~<span class="token comment"># ubus call counter add '{&quot;value&quot;: 10}'</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
root@OpenWrt:~<span class="token comment"># ubus call counter get</span>
<span class="token punctuation">{</span>
        <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="mode-1-call-the-library-provided-by-ubus-and-write-an-executable-program-that-runs-independently"><a href="#mode-1-call-the-library-provided-by-ubus-and-write-an-executable-program-that-runs-independently" class="header-anchor">#</a> Mode 1: Call the library provided by UBUS and write an executable program that runs independently.</h3> <p>C</p> <div class="language-C extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;libubox/blobmsg_json.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;libubus.h&gt;</span></span>

<span class="token keyword">static</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">counter_get</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ubus_context</span> <span class="token operator">*</span>ctx<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">ubus_object</span> <span class="token operator">*</span>obj<span class="token punctuation">,</span>
		      <span class="token keyword">struct</span> <span class="token class-name">ubus_request_data</span> <span class="token operator">*</span>req<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>method<span class="token punctuation">,</span>
		      <span class="token keyword">struct</span> <span class="token class-name">blob_attr</span> <span class="token operator">*</span>msg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">blob_buf</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token function">blob_buf_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">blobmsg_add_u32</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token string">&quot;count&quot;</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ubus_send_reply</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">,</span> b<span class="token punctuation">.</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">blob_buf_free</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token punctuation">{</span>
	COUNTER_VALUE<span class="token punctuation">,</span>
	__COUNTER_MAX
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">blobmsg_policy</span> counter_policy<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token punctuation">[</span>COUNTER_VALUE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>type <span class="token operator">=</span> BLOBMSG_TYPE_INT32 <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">counter_add</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ubus_context</span> <span class="token operator">*</span>ctx<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">ubus_object</span> <span class="token operator">*</span>obj<span class="token punctuation">,</span>
		      <span class="token keyword">struct</span> <span class="token class-name">ubus_request_data</span> <span class="token operator">*</span>req<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>method<span class="token punctuation">,</span>
		      <span class="token keyword">struct</span> <span class="token class-name">blob_attr</span> <span class="token operator">*</span>msg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">blob_attr</span> <span class="token operator">*</span>tb<span class="token punctuation">[</span>__COUNTER_MAX<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">blob_buf</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token function">blobmsg_parse</span><span class="token punctuation">(</span>counter_policy<span class="token punctuation">,</span> __COUNTER_MAX<span class="token punctuation">,</span> tb<span class="token punctuation">,</span> <span class="token function">blob_data</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">blob_len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tb<span class="token punctuation">[</span>COUNTER_VALUE<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> UBUS_STATUS_INVALID_ARGUMENT<span class="token punctuation">;</span>	

	count <span class="token operator">=</span> <span class="token function">blobmsg_get_u32</span><span class="token punctuation">(</span>tb<span class="token punctuation">[</span>COUNTER_VALUE<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">blob_buf_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">blobmsg_add_u32</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token string">&quot;count&quot;</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ubus_send_reply</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">,</span> b<span class="token punctuation">.</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">blob_buf_free</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">ubus_method</span> counter_methods<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token function">UBUS_METHOD_NOARG</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> counter_get<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token function">UBUS_METHOD</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span> counter_add<span class="token punctuation">,</span> counter_policy<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">struct</span> <span class="token class-name">ubus_object_type</span> counter_object_type <span class="token operator">=</span>
	<span class="token function">UBUS_OBJECT_TYPE</span><span class="token punctuation">(</span><span class="token string">&quot;counter&quot;</span><span class="token punctuation">,</span> counter_methods<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">struct</span> <span class="token class-name">ubus_object</span> counter_object <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;counter&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token operator">&amp;</span>counter_object_type<span class="token punctuation">,</span>
	<span class="token punctuation">.</span>methods <span class="token operator">=</span> counter_methods<span class="token punctuation">,</span>
	<span class="token punctuation">.</span>n_methods <span class="token operator">=</span> <span class="token function">ARRAY_SIZE</span><span class="token punctuation">(</span>counter_methods<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">ubus_context</span> <span class="token operator">*</span>ctx<span class="token punctuation">;</span>

	<span class="token function">uloop_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	ctx <span class="token operator">=</span> <span class="token function">ubus_connect</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;Failed to connect to ubus\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">ubus_add_uloop</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ubus_add_object</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>counter_object<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">uloop_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">ubus_free</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">uloop_done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Lua</p> <div class="language-Lua extra-class"><pre class="language-lua"><code><span class="token comment">#!/usr/bin/lua</span>

<span class="token keyword">local</span> ubus <span class="token operator">=</span> require <span class="token string">&quot;ubus&quot;</span>
<span class="token keyword">local</span> uloop <span class="token operator">=</span> require <span class="token string">&quot;uloop&quot;</span>
<span class="token keyword">local</span> count <span class="token operator">=</span> <span class="token number">0</span>

uloop<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">local</span> conn <span class="token operator">=</span> ubus<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> conn <span class="token keyword">then</span>
	<span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to connect to ubus&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> methods <span class="token operator">=</span> <span class="token punctuation">{</span>
	counter <span class="token operator">=</span> <span class="token punctuation">{</span>
		get <span class="token operator">=</span> <span class="token punctuation">{</span>
			<span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
				conn<span class="token punctuation">:</span><span class="token function">reply</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">{</span>count <span class="token operator">=</span> count<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token keyword">end</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		add <span class="token operator">=</span> <span class="token punctuation">{</span>
			<span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
				count <span class="token operator">=</span> msg<span class="token punctuation">.</span>value
				conn<span class="token punctuation">:</span><span class="token function">reply</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">{</span>count <span class="token operator">=</span> count<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token keyword">end</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>value <span class="token operator">=</span> ubus<span class="token punctuation">.</span>INT32 <span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

conn<span class="token punctuation">:</span><span class="token function">add</span><span class="token punctuation">(</span>methods<span class="token punctuation">)</span>
uloop<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="mode-2-write-rpcdplugin"><a href="#mode-2-write-rpcdplugin" class="header-anchor">#</a> Mode 2: Write <a href="https://openwrt.org/start?Id=docs/techref/rpcd" target="_blank" rel="noopener noreferrer">rpcd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>plugin</h3> <p>Many times, we don't need to open a resident daemon for every UBUS service, so we can register our own UBUS service by adding plugins to rpcd.</p> <p>Shell</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token builtin class-name">.</span> /usr/share/libubox/jshn.sh

<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
	list<span class="token punctuation">)</span>
		<span class="token builtin class-name">echo</span> <span class="token string">'{&quot;get&quot;: { }, &quot;add&quot;: {&quot;value&quot;: 0}}'</span>
	<span class="token punctuation">;</span><span class="token punctuation">;</span>
	call<span class="token punctuation">)</span>
		<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$2</span>&quot;</span> <span class="token keyword">in</span>
			get<span class="token punctuation">)</span>
				<span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /tmp/counter <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /tmp/counter
				<span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /tmp/counter<span class="token variable">)</span></span>
				<span class="token builtin class-name">echo</span> <span class="token string">&quot;{ <span class="token entity" title="\&quot;">\&quot;</span>count<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token variable">$count</span> }&quot;</span>
			<span class="token punctuation">;</span><span class="token punctuation">;</span>
			<span class="token function">add</span><span class="token punctuation">)</span>
				<span class="token builtin class-name">read</span> input
				json_load <span class="token variable">$input</span>
				json_get_var <span class="token function">add</span> value
				
				<span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /tmp/counter <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /tmp/counter
				<span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /tmp/counter<span class="token variable">)</span></span>
				
				<span class="token builtin class-name">let</span> <span class="token assign-left variable">count</span><span class="token operator">=</span>count+<span class="token variable">$add</span>
				<span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token variable">$count</span> <span class="token operator">&gt;</span> /tmp/counter
				
				<span class="token builtin class-name">echo</span> <span class="token string">&quot;{ <span class="token entity" title="\&quot;">\&quot;</span>count<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token variable">$count</span> }&quot;</span>
		<span class="token keyword">esac</span>
	<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre></div><p>Lua</p> <div class="language-Lua extra-class"><pre class="language-lua"><code><span class="token comment">#!/usr/bin/lua</span>

<span class="token keyword">local</span> cjson <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;cjson&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">local</span> list <span class="token operator">=</span> <span class="token punctuation">{</span>
	get <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	add <span class="token operator">=</span> <span class="token punctuation">{</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">get_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">local</span> count <span class="token operator">=</span> <span class="token number">0</span>
	<span class="token keyword">local</span> f <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;/tmp/counter&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> f  <span class="token keyword">then</span>
		count <span class="token operator">=</span> f<span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">&quot;*a&quot;</span><span class="token punctuation">)</span>
		f<span class="token punctuation">:</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">else</span>
		os<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;echo -n 0 &gt; /tmp/counter&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">end</span>
	<span class="token keyword">return</span> count
<span class="token keyword">end</span>

<span class="token keyword">if</span> arg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;list&quot;</span> <span class="token keyword">then</span>
	<span class="token function">print</span><span class="token punctuation">(</span>cjson<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">elseif</span> arg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;call&quot;</span> <span class="token keyword">then</span>
	<span class="token keyword">if</span> arg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;get&quot;</span> <span class="token keyword">then</span>
		<span class="token keyword">local</span> count <span class="token operator">=</span> <span class="token function">get_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token function">print</span><span class="token punctuation">(</span>cjson<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">{</span>count <span class="token operator">=</span> count<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">elseif</span> arg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;add&quot;</span> <span class="token keyword">then</span>
		<span class="token keyword">local</span> args <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">&quot;*a&quot;</span><span class="token punctuation">)</span>
		args <span class="token operator">=</span> cjson<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
		<span class="token keyword">local</span> count <span class="token operator">=</span> <span class="token function">get_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> args<span class="token punctuation">.</span>value
		os<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;echo -n %d &gt; /tmp/counter&quot;</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token function">print</span><span class="token punctuation">(</span>cjson<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">{</span>count <span class="token operator">=</span> count<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre></div><h2 id="access-data"><a href="#access-data" class="header-anchor">#</a> Access Data</h2> <p>We show the count value in the example from previous section through the web page and set it up through the web page.</p> <p>Modify the Vue component added in the previous section：<code>vuci/vuci-ui-core/src/src/views/test/sub.vue</code></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ count }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>add<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$ubus</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'counter'</span><span class="token punctuation">,</span> <span class="token string">'get'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">=</span> r<span class="token punctuation">.</span>count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$ubus</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'counter'</span><span class="token punctuation">,</span> <span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">=</span> r<span class="token punctuation">.</span>count<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Now that our page is not working properly, we need to add permission for the counter UBUS service.</p> <p>The permission profile storage path is：<code>vuci/vuci-ui-core/files/usr/share/rpcd/acl.d</code>。We can modify the existing permission profile or create a new one.</p> <p>Let's create a new permission profile here：<code>vuci/vuci-ui-core/files/usr/share/rpcd/acl.d/counter</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;counter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Counter test&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;read&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;ubus&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;counter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;write&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;ubus&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;counter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="multilingual-support"><a href="#multilingual-support" class="header-anchor">#</a> Multilingual support</h2> <p>Language file storage path is：<code>vuci/vuci-ui-core/src/src/locales</code>。At present, only English and simplified
Chinese are supported. Add the content you need to translate to the corresponding language file.</p> <p>Use in Vue template: <code>$t('content')</code></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>vuci-form-item-input</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t('Name')<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">required</span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>Use in JS: <code>this.$t('content')</code></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuci/guide/compile.html" class="prev">
        Compile
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuci/assets/js/app.80f1f43f.js" defer></script><script src="/vuci/assets/js/2.87865a9c.js" defer></script><script src="/vuci/assets/js/3.c5fed848.js" defer></script>
  </body>
</html>
